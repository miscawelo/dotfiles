#!/usr/bin/env sh

kb_device="asus::kbd_backlight"

send_notif() {
  brightness=$(brightnessctl --device=$kb_device g)
  dunstify "Brightness" "Keyboard" -i "$HOME/scripts/assets/icons/keyboard.png" -h string:x-dunst-stack-tag:kb-backlight -h int:value:"$((brightness * 33))"
}

[ "$1" = "down" ] && if [ "$(brightnessctl --device=$kb_device g)" -gt 0 ]; then asusctl -p ; fi && send_notif && exit
[ "$1" = "up" ] && if [ "$(brightnessctl --device=$kb_device g)" -lt 3 ]; then asusctl -n ; fi && send_notif && exit
[ "$1" = "set" ] && brightnessctl --device=$kb_device set "$2" && send_notif "$1" && exit
[ "$1" = "get" ] && brightnessctl --device=$kb_device get && exit
