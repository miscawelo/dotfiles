- name: Install additional packages
  apt:
    update_cache: yes
    name:
    - curl

- name: Create PiHole config directory
  file:
    path: /etc/pihole
    state: directory
    owner: 'root'
    group: 'root'
    mode: '0755'

- name: Copy config file
  copy:
    src: roles/pihole/files/setupVars.conf
    dest: /etc/pihole/setupVars.conf
    owner: 'root'
    group: 'root'
    mode: '0644'

- name: Run Pi-Hole install script, unattended
  shell: 'curl -L https://install.pi-hole.net | bash /dev/stdin --unattended'
